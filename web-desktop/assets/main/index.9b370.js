window.__require=function t(e,n,o){function r(c,s){if(!n[c]){if(!e[c]){var a=c.split("/");if(a=a[a.length-1],!e[a]){var l="function"==typeof __require&&__require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+c+"'")}c=a}var u=n[c]={exports:{}};e[c][0].call(u.exports,function(t){return r(e[c][1][t]||t)},u,u.exports,t,e,n,o)}return n[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<o.length;c++)r(o[c]);return r}({ChatManager:[function(t,e,n){"use strict";cc._RF.push(e,"4d3e55ip1VFCZCPwdfbKjro","ChatManager");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,c=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(c=(i<3?r(c):i>3?r(e,n,c):r(e,n))||c);return i>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,s=c.ccclass,a=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.msgInput=null,e.msgscroll=null,e.msgPre=null,e.inputnamePre=null,e.onlineCount=null,e.userName="",e.ws=null,e}return r(e,t),e.prototype.start=function(){this.connectServer(),this.showInputName()},e.prototype.connectServer=function(){var t=this;this.ws=new WebSocket("ws://localhost:8080"),this.ws.addEventListener("open",function(){cc.log("\u8fde\u63a5\u6210\u529f")}),this.ws.addEventListener("message",function(e){cc.log("\u6536\u5230\u6d88\u606f\uff1a"+e.data),t.handleMessage(e.data)}),this.ws.addEventListener("close",function(){cc.log("\u8fde\u63a5\u65ad\u5f00")}),this.ws.addEventListener("error",function(){cc.log("\u8fde\u63a5\u9519\u8bef")})},e.prototype.sendMessage=function(){var t=this.msgInput.string;if(""!==t){var e=this.userName+":"+t;this.ws.send(e),this.msgInput.string=""}},e.prototype.handleMessage=function(t){var e=this;if(t.startsWith("[onlineCount]")){var n=t.replace("[onlineCount]","");this.onlineCount.string="\u5728\u7ebf\u4eba\u6570\uff1a"+n}else{var o=cc.instantiate(this.msgPre);this.msgscroll.content.addChild(o),o.getChildByName("msgLabel").getComponent(cc.Label).string=t,this.scheduleOnce(function(){e.msgscroll.scrollToBottom(.1)},0)}},e.prototype.showInputName=function(){var t=this,e=cc.instantiate(this.inputnamePre);cc.find("Canvas").addChild(e),e.getChildByName("input").getChildByName("Button").getComponent(cc.Button).node.on("click",function(){var n=e.getChildByName("input").getChildByName("EditBox").getComponent(cc.EditBox).string;cc.log("\u8f93\u5165\u7684\u540d\u5b57\uff1a"+n),t.userName=n,e.destroy()})},i([a(cc.EditBox)],e.prototype,"msgInput",void 0),i([a(cc.ScrollView)],e.prototype,"msgscroll",void 0),i([a(cc.Prefab)],e.prototype,"msgPre",void 0),i([a(cc.Prefab)],e.prototype,"inputnamePre",void 0),i([a(cc.Label)],e.prototype,"onlineCount",void 0),i([s],e)}(cc.Component);n.default=l,cc._RF.pop()},{}]},{},["ChatManager"]);